
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Data Preparation &#8212; Artificial Neural Networks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js?v=afe5de03"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '03_Practical_Implementation_Dataset_Preprocessing';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Practical Implementation" href="04_Practical_Implementation_ANN_Modelling_and_Optimization_Pipeline.html" />
    <link rel="prev" title="Perceptron" href="02_Perceptron_and_MultiLayer_Neural_Network.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="00_Intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Artificial Neural Networks - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Artificial Neural Networks - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="00_Intro.html">
                    Artificial Neural Networks Project
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_Introduction_to_ANN.html">What are Artificial Neural Networks?</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_Perceptron_and_MultiLayer_Neural_Network.html">Perceptron</a></li>




<li class="toctree-l1 current active"><a class="current reference internal" href="#">Data Preparation</a></li>



<li class="toctree-l1"><a class="reference internal" href="04_Practical_Implementation_ANN_Modelling_and_Optimization_Pipeline.html">Practical Implementation</a></li>







<li class="toctree-l1"><a class="reference internal" href="05_Comparison_Random_Forest_vs_Neural_Network.html">Extra: Random Forest vs Artificial Neural Network</a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F03_Practical_Implementation_Dataset_Preprocessing.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/03_Practical_Implementation_Dataset_Preprocessing.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Data Preparation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Data Preparation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#splitting-the-data-into-training-and-testing-sets">Splitting the data into training and testing sets</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#train-set-preparation">Train set preparation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#missing-values">Missing Values</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#one-hot-encoding">One-Hot Encoding</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-information">Statistical Information</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-the-data-distribution">Plotting the data distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#normalization-scaling-normalization-or-standardization-z-score-normalization">Normalization(Scaling Normalization) or Standardization(Z- Score Normalization)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#normalization-min-max-scaling">Normalization (Min-Max Scaling)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Plotting the data distribution</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-the-data">Saving the data</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#test-set-preparation">Test set preparation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Missing Values</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">One-Hot Encoding</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verifying-allignment-between-training-and-test-sets">Verifying allignment between training and test sets</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Normalization (Min-Max Scaling)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Saving the data</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="data-preparation">
<h1>Data Preparation<a class="headerlink" href="#data-preparation" title="Link to this heading">#</a></h1>
<p>In this section, we will prepare the data for training our neural network. More specifically, we will perform the following operations for both the training and test sets:</p>
<ol class="arabic simple">
<li><p>Split the data into training and testing sets</p></li>
<li><p>Look for missing values</p></li>
<li><p>Perform one-hot encoding on the categorical features</p></li>
<li><p>Normalize the data</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1">#file link</span>
<span class="n">file_link</span> <span class="o">=</span> <span class="s1">&#39;https://drive.google.com/file/d/15V2Xx7leO57hwXji0ySNKWDXtwr4pWfn/view?usp=sharing&#39;</span>

<span class="n">file_id</span> <span class="o">=</span> <span class="n">file_link</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

<span class="n">download_link</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;https://drive.google.com/uc?id=</span><span class="si">{</span><span class="n">file_id</span><span class="si">}</span><span class="s1">&#39;</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">download_link</span><span class="p">)</span>

<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gender</th>
      <th>age</th>
      <th>hypertension</th>
      <th>heart_disease</th>
      <th>smoking_history</th>
      <th>bmi</th>
      <th>HbA1c_level</th>
      <th>blood_glucose_level</th>
      <th>diabetes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Female</td>
      <td>80.0</td>
      <td>0</td>
      <td>1</td>
      <td>never</td>
      <td>25.19</td>
      <td>6.6</td>
      <td>140</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Female</td>
      <td>54.0</td>
      <td>0</td>
      <td>0</td>
      <td>No Info</td>
      <td>27.32</td>
      <td>6.6</td>
      <td>80</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Male</td>
      <td>28.0</td>
      <td>0</td>
      <td>0</td>
      <td>never</td>
      <td>27.32</td>
      <td>5.7</td>
      <td>158</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Female</td>
      <td>36.0</td>
      <td>0</td>
      <td>0</td>
      <td>current</td>
      <td>23.45</td>
      <td>5.0</td>
      <td>155</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Male</td>
      <td>76.0</td>
      <td>1</td>
      <td>1</td>
      <td>current</td>
      <td>20.14</td>
      <td>4.8</td>
      <td>155</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The dataset contains 9 columns, 8 features and 1 target variable. The features represent the health status of a patient.
The target variable is a binary variable, that is, it can take only two values: 0 or 1. The value 0 means that the patient does not have diabetes, while the value 1 means that the patient has diabetes.</p>
<section id="splitting-the-data-into-training-and-testing-sets">
<h2>Splitting the data into training and testing sets<a class="headerlink" href="#splitting-the-data-into-training-and-testing-sets" title="Link to this heading">#</a></h2>
<p>One crucial step in building and evaluating machine learning models is to split the dataset into training and testing sets. We’ll use the training set to train our model and the testing set to evaluate the performance of our model.</p>
<p>In real-world scenarios, the testing data is typically not available during the model development phase. Therefore, we simulate this situation by temporarily setting aside a portion of the data for testing purposes, allowing us to manage and assess the model’s performance as if the testing data were unknown.</p>
<p>Note: sklearn’s train_test_split function does not perform stratified sampling directly, indeed you need to specify the stratify parameter.
Stratify sampling is a sampling technique that ensures that the training and testing sets have approximately the same percentage of samples of each target class as the original dataset. This technique is useful when the dataset is imbalance.</p>
<p>More information on: <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html">https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">8</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;diabetes&quot;</span><span class="p">]</span>

<span class="n">X_train_80</span><span class="p">,</span> <span class="n">X_test_20</span><span class="p">,</span> <span class="n">y_train_80</span><span class="p">,</span> <span class="n">y_test_20</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">X_train_80</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_train_80</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       gender   age  hypertension  heart_disease smoking_history    bmi  \
74736  Female  80.0             1              0          former  27.32   
36589  Female  19.0             0              0           never  25.18   
37414  Female  36.0             0              0         No Info  25.95   
71251  Female  35.0             0              0         current  23.43   
40454  Female  30.0             0              0         No Info  22.62   
...       ...   ...           ...            ...             ...    ...   
17083  Female  39.0             0              0           never  32.28   
27250    Male  43.0             0              0           never  27.32   
33409  Female  52.0             1              0          former  27.32   
91639  Female   5.0             0              0         No Info  15.68   
80678    Male   4.0             0              0         No Info  27.32   

       HbA1c_level  blood_glucose_level  
74736          6.5                  145  
36589          4.5                  126  
37414          6.6                  200  
71251          6.0                  159  
40454          5.0                   90  
...            ...                  ...  
17083          4.8                  130  
27250          6.2                  158  
33409          5.8                  155  
91639          6.2                  155  
80678          4.0                  130  

[80000 rows x 8 columns]
74736    1
36589    0
37414    0
71251    0
40454    0
        ..
17083    0
27250    0
33409    0
91639    0
80678    0
Name: diabetes, Length: 80000, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_80</span> <span class="o">=</span> <span class="n">X_train_80</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">y_train_80</span> <span class="o">=</span> <span class="n">y_train_80</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_test_20</span> <span class="o">=</span> <span class="n">X_test_20</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">y_test_20</span> <span class="o">=</span> <span class="n">y_test_20</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_80</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gender</th>
      <th>age</th>
      <th>hypertension</th>
      <th>heart_disease</th>
      <th>smoking_history</th>
      <th>bmi</th>
      <th>HbA1c_level</th>
      <th>blood_glucose_level</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Female</td>
      <td>80.0</td>
      <td>1</td>
      <td>0</td>
      <td>former</td>
      <td>27.32</td>
      <td>6.5</td>
      <td>145</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Female</td>
      <td>19.0</td>
      <td>0</td>
      <td>0</td>
      <td>never</td>
      <td>25.18</td>
      <td>4.5</td>
      <td>126</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Female</td>
      <td>36.0</td>
      <td>0</td>
      <td>0</td>
      <td>No Info</td>
      <td>25.95</td>
      <td>6.6</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Female</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>current</td>
      <td>23.43</td>
      <td>6.0</td>
      <td>159</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Female</td>
      <td>30.0</td>
      <td>0</td>
      <td>0</td>
      <td>No Info</td>
      <td>22.62</td>
      <td>5.0</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">y_train_80</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    1
1    0
2    0
3    0
4    0
Name: diabetes, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">X_test_20</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gender</th>
      <th>age</th>
      <th>hypertension</th>
      <th>heart_disease</th>
      <th>smoking_history</th>
      <th>bmi</th>
      <th>HbA1c_level</th>
      <th>blood_glucose_level</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Female</td>
      <td>36.0</td>
      <td>0</td>
      <td>0</td>
      <td>former</td>
      <td>22.64</td>
      <td>6.0</td>
      <td>160</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Female</td>
      <td>31.0</td>
      <td>0</td>
      <td>0</td>
      <td>never</td>
      <td>27.32</td>
      <td>5.8</td>
      <td>126</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Male</td>
      <td>52.0</td>
      <td>0</td>
      <td>0</td>
      <td>not current</td>
      <td>23.20</td>
      <td>4.0</td>
      <td>100</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Female</td>
      <td>29.0</td>
      <td>0</td>
      <td>0</td>
      <td>never</td>
      <td>30.57</td>
      <td>5.0</td>
      <td>160</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Male</td>
      <td>61.0</td>
      <td>0</td>
      <td>0</td>
      <td>never</td>
      <td>26.88</td>
      <td>5.8</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">y_test_20</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    0
1    0
2    0
3    0
4    0
Name: diabetes, dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="train-set-preparation">
<h1>Train set preparation<a class="headerlink" href="#train-set-preparation" title="Link to this heading">#</a></h1>
<section id="missing-values">
<h2>Missing Values<a class="headerlink" href="#missing-values" title="Link to this heading">#</a></h2>
<p>First of all, we’ve to get some basic information about the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_80</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="n">y_train_80</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 80000 entries, 0 to 79999
Data columns (total 8 columns):
 #   Column               Non-Null Count  Dtype  
---  ------               --------------  -----  
 0   gender               80000 non-null  object 
 1   age                  80000 non-null  float64
 2   hypertension         80000 non-null  int64  
 3   heart_disease        80000 non-null  int64  
 4   smoking_history      80000 non-null  object 
 5   bmi                  80000 non-null  float64
 6   HbA1c_level          80000 non-null  float64
 7   blood_glucose_level  80000 non-null  int64  
dtypes: float64(3), int64(3), object(2)
memory usage: 4.9+ MB
&lt;class &#39;pandas.core.series.Series&#39;&gt;
RangeIndex: 80000 entries, 0 to 79999
Series name: diabetes
Non-Null Count  Dtype
--------------  -----
80000 non-null  int64
dtypes: int64(1)
memory usage: 625.1 KB
</pre></div>
</div>
</div>
</div>
<p>Now, we know that there aren’t any missing values or null values in the data. So, we can proceed to the next step and view the statistical information about the data.</p>
</section>
<section id="one-hot-encoding">
<h2>One-Hot Encoding<a class="headerlink" href="#one-hot-encoding" title="Link to this heading">#</a></h2>
<p>Let’s see how many categorical features we have in the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_80</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gender                    3
age                     102
hypertension              2
heart_disease             2
smoking_history           6
bmi                    4113
HbA1c_level              18
blood_glucose_level      18
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>We can say that we have probably 2 categorical features. We don’t need an Euristic to decide if a feature is a categorical feature or not. We can use the dtypes attribute of the DataFrame to get the data type of each column. If the data type is numerical, then the feature is not a categorical feature. Otherwise, it is a categorical feature.</p>
<p>Notice that we can do that only because this dataset give us the information about the data type of each column, it’s not always the case.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="c1"># is_numerical is a Series that contains True if the data type of the corresponding column is numerical, False otherwise</span>
<span class="n">is_numerical</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">))</span>

<span class="c1"># Notice that since we work with a dataset that is not indexed with an index, we can use the columns attribute of the DataFrame to get the columns names.</span>
<span class="n">categorical_cols</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="o">~</span><span class="n">is_numerical</span><span class="p">]</span>

<span class="n">categorical_cols</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;gender&#39;, &#39;smoking_history&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>How to manage the categorical feature? We’ll use one-hot encoding to manage the categorical feature.</p>
<p>The implementation force us to convert the categorical feature into numerical feature. We’ve seen before that we have 2 categorical features. So, we’ll use one-hot encoding to convert the categorical features into numerical features, thus increasing the number of columns from 9 to 16. Now, we can use the get_dummies function of pandas to perform one-hot encoding on the categorical features, that is more coince than the one-hot encoding that sklearn provides.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Create a DataFrame with only the categorical features, using one-hot encoding, we force the data type to be int</span>
<span class="n">encoded_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X_train_80</span><span class="p">[</span><span class="n">categorical_cols</span><span class="p">],</span> <span class="n">prefix</span><span class="o">=</span><span class="n">categorical_cols</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># Delete the categorical features from the original DataFrame</span>
<span class="n">X_train_80</span> <span class="o">=</span> <span class="n">X_train_80</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">categorical_cols</span><span class="p">)</span>

<span class="c1"># Union the two DataFrames</span>
<span class="n">X_train_80</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_train_80</span><span class="p">,</span> <span class="n">encoded_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_80</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>hypertension</th>
      <th>heart_disease</th>
      <th>bmi</th>
      <th>HbA1c_level</th>
      <th>blood_glucose_level</th>
      <th>gender_Female</th>
      <th>gender_Male</th>
      <th>gender_Other</th>
      <th>smoking_history_No Info</th>
      <th>smoking_history_current</th>
      <th>smoking_history_ever</th>
      <th>smoking_history_former</th>
      <th>smoking_history_never</th>
      <th>smoking_history_not current</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>80.0</td>
      <td>1</td>
      <td>0</td>
      <td>27.32</td>
      <td>6.5</td>
      <td>145</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>19.0</td>
      <td>0</td>
      <td>0</td>
      <td>25.18</td>
      <td>4.5</td>
      <td>126</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>36.0</td>
      <td>0</td>
      <td>0</td>
      <td>25.95</td>
      <td>6.6</td>
      <td>200</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>23.43</td>
      <td>6.0</td>
      <td>159</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>30.0</td>
      <td>0</td>
      <td>0</td>
      <td>22.62</td>
      <td>5.0</td>
      <td>90</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In the context of using a neural network, normalizing or standardizing data is essential. When we perform one-hot encoding for categorical variables, converting them into binary columns, we are essentially creating numerical features. While the primary purpose of standardization is to bring numerical features to a consistent scale, applying it to binary columns ensures uniformity in the treatment of all features. This step helps maintain overall consistency and aids in effective training of the neural network.</p>
</section>
<section id="statistical-information">
<h2>Statistical Information<a class="headerlink" href="#statistical-information" title="Link to this heading">#</a></h2>
<p>Let’s see the statistical information about the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_80</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>

<span class="n">y_train_80</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    80000.000000
mean         0.085000
std          0.278883
min          0.000000
25%          0.000000
50%          0.000000
75%          0.000000
max          1.000000
Name: diabetes, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>We can see that the at least 75% of the data is 0. So, we can say that the dataset is imbalanced. We’ll deal with this problem later.</p>
<section id="plotting-the-data-distribution">
<h3>Plotting the data distribution<a class="headerlink" href="#plotting-the-data-distribution" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Compute the number of rows and columns needed to plot each variable in the dataset</span>
<span class="n">num_rows</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>  <span class="c1"># Number of rows (2 variables per row)</span>
<span class="n">num_cols</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Number of columns (2 variables per column)</span>

<span class="c1"># Create a figure and a set of subplots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">num_rows</span><span class="p">,</span> <span class="n">num_cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">num_rows</span><span class="p">))</span>

<span class="c1"># Iterate over the columns of the dataset and plot each variable</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="n">num_cols</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="n">num_cols</span><span class="p">]</span>
    <span class="n">data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Distribution of </span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Values&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>

<span class="c1"># Adjust the space between the subplots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Show the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b8766a47e169b4cd708b02c50aa5b1d88926cc6282d96e7814b785316d5a9453.png" src="_images/b8766a47e169b4cd708b02c50aa5b1d88926cc6282d96e7814b785316d5a9453.png" />
</div>
</div>
</section>
<section id="normalization-scaling-normalization-or-standardization-z-score-normalization">
<h3>Normalization(Scaling Normalization) or Standardization(Z- Score Normalization)<a class="headerlink" href="#normalization-scaling-normalization-or-standardization-z-score-normalization" title="Link to this heading">#</a></h3>
<p>In general if we don’t know the distribution of the data, it’s useful to use the Scaling Normalization. Otherwise, if we know that the data is normally distributed, we can use the Z-Score Normalization.</p>
<p>More info on: <a class="reference external" href="https://www.geeksforgeeks.org/normalization-vs-standardization/">https://www.geeksforgeeks.org/normalization-vs-standardization/</a></p>
</section>
</section>
<section id="normalization-min-max-scaling">
<h2>Normalization (Min-Max Scaling)<a class="headerlink" href="#normalization-min-max-scaling" title="Link to this heading">#</a></h2>
<p>Why we use normalization? We use normalization to scale the data in a range. In this way, we can avoid that some features have a greater impact on the model than other features. We can use the MinMaxScaler class of sklearn to normalize the data.</p>
<p><img alt="normalization" src="_images/normalization.png" /></p>
<p>Image credit: <a class="reference external" href="https://towardsdatascience.com/how-to-calculate-the-mean-and-standard-deviation-normalizing-datasets-in-pytorch-704bd7d05f4c">https://towardsdatascience.com/how-to-calculate-the-mean-and-standard-deviation-normalizing-datasets-in-pytorch-704bd7d05f4c</a></p>
<p>Theoretically speaking, if we normalize the data, our model will converge faster.</p>
<p>So, we can say that normalization is not always necessary. However, it is always a good practice to normalize the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span> <span class="c1"># Create an instance of the MinMaxScaler class, that will be used to normalize the test set as well later</span>
<span class="n">X_train_80</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train_80</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_train_80</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="c1"># Note: we don&#39;t need to normalize the target variable, because it is already normalized (it is a binary variable)</span>

<span class="n">X_train_80</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>hypertension</th>
      <th>heart_disease</th>
      <th>bmi</th>
      <th>HbA1c_level</th>
      <th>blood_glucose_level</th>
      <th>gender_Female</th>
      <th>gender_Male</th>
      <th>gender_Other</th>
      <th>smoking_history_No Info</th>
      <th>smoking_history_current</th>
      <th>smoking_history_ever</th>
      <th>smoking_history_former</th>
      <th>smoking_history_never</th>
      <th>smoking_history_not current</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.000000</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.202031</td>
      <td>0.545455</td>
      <td>0.295455</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.236737</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.177054</td>
      <td>0.181818</td>
      <td>0.209091</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.449449</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.186041</td>
      <td>0.563636</td>
      <td>0.545455</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.436937</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.156629</td>
      <td>0.454545</td>
      <td>0.359091</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.374374</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.147176</td>
      <td>0.272727</td>
      <td>0.045455</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="id1">
<h3>Plotting the data distribution<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Compute the number of rows and columns needed to plot each variable in the dataset</span>
<span class="n">num_rows</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_train_80</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>  <span class="c1"># Number of rows (2 variables per row)</span>
<span class="n">num_cols</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Number of columns (2 variables per column)</span>

<span class="c1"># Create a figure and a set of subplots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">num_rows</span><span class="p">,</span> <span class="n">num_cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">num_rows</span><span class="p">))</span>

<span class="c1"># Iterate over the columns of the dataset and plot each variable</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">X_train_80</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="n">num_cols</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="n">num_cols</span><span class="p">]</span>
    <span class="n">X_train_80</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Distribution of </span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Values&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>

<span class="c1"># Adjust the space between the subplots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Show the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3b57d86b652ec374e50aa9644313873932fa6802fd1c0906b8876fd0bc9dc3cb.png" src="_images/3b57d86b652ec374e50aa9644313873932fa6802fd1c0906b8876fd0bc9dc3cb.png" />
</div>
</div>
</section>
</section>
<section id="saving-the-data">
<h2>Saving the data<a class="headerlink" href="#saving-the-data" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pickleshare</span>
<span class="o">%</span><span class="k">store</span> X_train_80
<span class="o">%</span><span class="k">store</span> y_train_80
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Stored &#39;X_train_80&#39; (DataFrame)
Stored &#39;y_train_80&#39; (Series)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="test-set-preparation">
<h1>Test set preparation<a class="headerlink" href="#test-set-preparation" title="Link to this heading">#</a></h1>
<p>Similary how we prepared the training set, we need to prepare the test set as well. We need to perform the same operations that we performed on the training set. So, we need to perform one-hot encoding and normalization on the test set as well.</p>
<section id="id2">
<h2>Missing Values<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">X_test_20</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="n">y_test_20</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 20000 entries, 0 to 19999
Data columns (total 8 columns):
 #   Column               Non-Null Count  Dtype  
---  ------               --------------  -----  
 0   gender               20000 non-null  object 
 1   age                  20000 non-null  float64
 2   hypertension         20000 non-null  int64  
 3   heart_disease        20000 non-null  int64  
 4   smoking_history      20000 non-null  object 
 5   bmi                  20000 non-null  float64
 6   HbA1c_level          20000 non-null  float64
 7   blood_glucose_level  20000 non-null  int64  
dtypes: float64(3), int64(3), object(2)
memory usage: 1.2+ MB
&lt;class &#39;pandas.core.series.Series&#39;&gt;
RangeIndex: 20000 entries, 0 to 19999
Series name: diabetes
Non-Null Count  Dtype
--------------  -----
20000 non-null  int64
dtypes: int64(1)
memory usage: 156.4 KB
</pre></div>
</div>
</div>
</div>
<p>We can see that there aren’t any missing values or null values in the data.</p>
</section>
<section id="id3">
<h2>One-Hot Encoding<a class="headerlink" href="#id3" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">X_test_20</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gender                    3
age                     102
hypertension              2
heart_disease             2
smoking_history           6
bmi                    3160
HbA1c_level              18
blood_glucose_level      18
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">is_numerical</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">))</span>

<span class="n">categorical_cols</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="o">~</span><span class="n">is_numerical</span><span class="p">]</span>

<span class="n">categorical_cols</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;gender&#39;, &#39;smoking_history&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">encoded_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X_test_20</span><span class="p">[</span><span class="n">categorical_cols</span><span class="p">],</span> <span class="n">prefix</span><span class="o">=</span><span class="n">categorical_cols</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

<span class="n">X_test_20</span> <span class="o">=</span> <span class="n">X_test_20</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">categorical_cols</span><span class="p">)</span>

<span class="n">X_test_20</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_test_20</span><span class="p">,</span> <span class="n">encoded_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="verifying-allignment-between-training-and-test-sets">
<h3>Verifying allignment between training and test sets<a class="headerlink" href="#verifying-allignment-between-training-and-test-sets" title="Link to this heading">#</a></h3>
<p>We have to verify that the training and test sets have the same columns. If they don’t have the same columns, we can’t use the test set to evaluate the performance of our model. Since we have a small dataset, we could just look at the columns of the two DataFrames. However, we’ll use a more general approach that can be used with any dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the names of the columns from the DataFrame of training</span>
<span class="n">features_train</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">X_train_80</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="c1"># Get the names of the columns from the DataFrame of test</span>
<span class="n">features_test</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">X_test_20</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="c1"># Check if the two sets of columns are the same</span>
<span class="k">if</span> <span class="n">features_train</span> <span class="o">==</span> <span class="n">features_test</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The columns are aligned correctly&quot;</span><span class="p">)</span> 
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The columns are not aligned correctly&quot;</span><span class="p">)</span> 
    <span class="c1"># Print the differences between the two sets of columns</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Differenze tra le colonne:&quot;</span><span class="p">,</span> <span class="n">features_train</span><span class="o">.</span><span class="n">symmetric_difference</span><span class="p">(</span><span class="n">features_test</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The columns are aligned correctly
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">X_test_20</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>hypertension</th>
      <th>heart_disease</th>
      <th>bmi</th>
      <th>HbA1c_level</th>
      <th>blood_glucose_level</th>
      <th>gender_Female</th>
      <th>gender_Male</th>
      <th>gender_Other</th>
      <th>smoking_history_No Info</th>
      <th>smoking_history_current</th>
      <th>smoking_history_ever</th>
      <th>smoking_history_former</th>
      <th>smoking_history_never</th>
      <th>smoking_history_not current</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>36.0</td>
      <td>0</td>
      <td>0</td>
      <td>22.64</td>
      <td>6.0</td>
      <td>160</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>31.0</td>
      <td>0</td>
      <td>0</td>
      <td>27.32</td>
      <td>5.8</td>
      <td>126</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>52.0</td>
      <td>0</td>
      <td>0</td>
      <td>23.20</td>
      <td>4.0</td>
      <td>100</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29.0</td>
      <td>0</td>
      <td>0</td>
      <td>30.57</td>
      <td>5.0</td>
      <td>160</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>61.0</td>
      <td>0</td>
      <td>0</td>
      <td>26.88</td>
      <td>5.8</td>
      <td>90</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_80</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>hypertension</th>
      <th>heart_disease</th>
      <th>bmi</th>
      <th>HbA1c_level</th>
      <th>blood_glucose_level</th>
      <th>gender_Female</th>
      <th>gender_Male</th>
      <th>gender_Other</th>
      <th>smoking_history_No Info</th>
      <th>smoking_history_current</th>
      <th>smoking_history_ever</th>
      <th>smoking_history_former</th>
      <th>smoking_history_never</th>
      <th>smoking_history_not current</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.000000</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.202031</td>
      <td>0.545455</td>
      <td>0.295455</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.236737</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.177054</td>
      <td>0.181818</td>
      <td>0.209091</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.449449</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.186041</td>
      <td>0.563636</td>
      <td>0.545455</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.436937</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.156629</td>
      <td>0.454545</td>
      <td>0.359091</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.374374</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.147176</td>
      <td>0.272727</td>
      <td>0.045455</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="id4">
<h2>Normalization (Min-Max Scaling)<a class="headerlink" href="#id4" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">X_test_20</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>

<span class="n">y_test_20</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    20000.000000
mean         0.085000
std          0.278889
min          0.000000
25%          0.000000
50%          0.000000
75%          0.000000
max          1.000000
Name: diabetes, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>The data is not balanced. So, as we said before, we need to deal with this problem.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="n">X_test_20</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test_20</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_test_20</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="n">X_test_20</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>hypertension</th>
      <th>heart_disease</th>
      <th>bmi</th>
      <th>HbA1c_level</th>
      <th>blood_glucose_level</th>
      <th>gender_Female</th>
      <th>gender_Male</th>
      <th>gender_Other</th>
      <th>smoking_history_No Info</th>
      <th>smoking_history_current</th>
      <th>smoking_history_ever</th>
      <th>smoking_history_former</th>
      <th>smoking_history_never</th>
      <th>smoking_history_not current</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.449449</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.147409</td>
      <td>0.454545</td>
      <td>0.363636</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.386887</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.202031</td>
      <td>0.418182</td>
      <td>0.209091</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.649650</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.153945</td>
      <td>0.090909</td>
      <td>0.090909</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.361862</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.239963</td>
      <td>0.272727</td>
      <td>0.363636</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.762262</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.196895</td>
      <td>0.418182</td>
      <td>0.045455</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="id5">
<h2>Saving the data<a class="headerlink" href="#id5" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pickleshare</span>
<span class="o">%</span><span class="k">store</span> X_test_20
<span class="o">%</span><span class="k">store</span> y_test_20

<span class="nb">print</span><span class="p">(</span><span class="n">X_test_20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_test_20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Stored &#39;X_test_20&#39; (DataFrame)
Stored &#39;y_test_20&#39; (Series)
            age  hypertension  heart_disease       bmi  HbA1c_level  \
0      0.449449           0.0            0.0  0.147409     0.454545   
1      0.386887           0.0            0.0  0.202031     0.418182   
2      0.649650           0.0            0.0  0.153945     0.090909   
3      0.361862           0.0            0.0  0.239963     0.272727   
4      0.762262           0.0            0.0  0.196895     0.418182   
...         ...           ...            ...       ...          ...   
19995  0.274274           0.0            0.0  0.120098     0.090909   
19996  0.474474           0.0            0.0  0.158613     0.000000   
19997  0.474474           0.0            0.0  0.193277     0.490909   
19998  0.974975           0.0            0.0  0.202031     0.418182   
19999  0.887387           0.0            0.0  0.227824     0.545455   

       blood_glucose_level  gender_Female  gender_Male  gender_Other  \
0                 0.363636            1.0          0.0           0.0   
1                 0.209091            1.0          0.0           0.0   
2                 0.090909            0.0          1.0           0.0   
3                 0.363636            1.0          0.0           0.0   
4                 0.045455            0.0          1.0           0.0   
...                    ...            ...          ...           ...   
19995             0.000000            1.0          0.0           0.0   
19996             0.227273            1.0          0.0           0.0   
19997             0.359091            1.0          0.0           0.0   
19998             0.022727            1.0          0.0           0.0   
19999             0.363636            0.0          1.0           0.0   

       smoking_history_No Info  smoking_history_current  smoking_history_ever  \
0                          0.0                      0.0                   0.0   
1                          0.0                      0.0                   0.0   
2                          0.0                      0.0                   0.0   
3                          0.0                      0.0                   0.0   
4                          0.0                      0.0                   0.0   
...                        ...                      ...                   ...   
19995                      1.0                      0.0                   0.0   
19996                      0.0                      0.0                   0.0   
19997                      0.0                      0.0                   0.0   
19998                      1.0                      0.0                   0.0   
19999                      1.0                      0.0                   0.0   

       smoking_history_former  smoking_history_never  \
0                         1.0                    0.0   
1                         0.0                    1.0   
2                         0.0                    0.0   
3                         0.0                    1.0   
4                         0.0                    1.0   
...                       ...                    ...   
19995                     0.0                    0.0   
19996                     0.0                    1.0   
19997                     0.0                    1.0   
19998                     0.0                    0.0   
19999                     0.0                    0.0   

       smoking_history_not current  
0                              0.0  
1                              0.0  
2                              1.0  
3                              0.0  
4                              0.0  
...                            ...  
19995                          0.0  
19996                          0.0  
19997                          0.0  
19998                          0.0  
19999                          0.0  

[20000 rows x 15 columns]
0        0
1        0
2        0
3        0
4        0
        ..
19995    0
19996    0
19997    0
19998    0
19999    0
Name: diabetes, Length: 20000, dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="references">
<h1>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h1>
<ol class="arabic simple">
<li><p>Dataset: <a class="reference external" href="https://www.kaggle.com/datasets/iammustafatz/diabetes-prediction-dataset/data">https://www.kaggle.com/datasets/iammustafatz/diabetes-prediction-dataset/data</a></p></li>
<li><p><a class="reference external" href="https://towardsdatascience.com/how-to-calculate-the-mean-and-standard-deviation-normalizing-datasets-in-pytorch-704bd7d05f4c">https://towardsdatascience.com/how-to-calculate-the-mean-and-standard-deviation-normalizing-datasets-in-pytorch-704bd7d05f4c</a></p></li>
<li><p><a class="reference external" href="https://www.geeksforgeeks.org/normalization-vs-standardization/">https://www.geeksforgeeks.org/normalization-vs-standardization/</a></p></li>
<li><p><a class="reference external" href="https://stats.stackexchange.com/questions/437840/in-machine-learning-how-does-normalization-help-in-convergence-of-gradient-desc">https://stats.stackexchange.com/questions/437840/in-machine-learning-how-does-normalization-help-in-convergence-of-gradient-desc</a></p></li>
</ol>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="02_Perceptron_and_MultiLayer_Neural_Network.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Perceptron</p>
      </div>
    </a>
    <a class="right-next"
       href="04_Practical_Implementation_ANN_Modelling_and_Optimization_Pipeline.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Practical Implementation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Data Preparation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#splitting-the-data-into-training-and-testing-sets">Splitting the data into training and testing sets</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#train-set-preparation">Train set preparation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#missing-values">Missing Values</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#one-hot-encoding">One-Hot Encoding</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-information">Statistical Information</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-the-data-distribution">Plotting the data distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#normalization-scaling-normalization-or-standardization-z-score-normalization">Normalization(Scaling Normalization) or Standardization(Z- Score Normalization)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#normalization-min-max-scaling">Normalization (Min-Max Scaling)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Plotting the data distribution</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-the-data">Saving the data</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#test-set-preparation">Test set preparation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Missing Values</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">One-Hot Encoding</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verifying-allignment-between-training-and-test-sets">Verifying allignment between training and test sets</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Normalization (Min-Max Scaling)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Saving the data</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Domenico Sosta
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>